import static org.junit.Assert.*;

import org.junit.*;

public class LaboonCoinTest {

    // Assert that creating a new LaboonCoin instance
    // does not return a null reference
    @Test
    public void testLaboonCoinExists() {
	LaboonCoin l = new LaboonCoin();
	assertNotNull(l);
    }

    // Assert that a hash can be generated by the hash function
    @Test
    public void testBasicHash() {
	String str = "boo00000000000010bb";
    LaboonCoin l = new LaboonCoin();

    int hash = l.hash(str);
	assertEquals(0x000b43be, hash);
    }

    // Assert that a hash can be generated by the hash function
    @Test
    public void testLongHash() {
	String str = "boo";
    LaboonCoin l = new LaboonCoin();

    int hash = 0;
    hash = l.hash(str);
	assertEquals(hash, Integer.parseInt("551fda32", 16));
    }

    // Assert that a hash is not generated when a null string is entered
    @Test
    public void testNullHash() {
    LaboonCoin l = new LaboonCoin();

    try {
            int hash = l.hash(null);
    } catch (IllegalArgumentException e) {
       return; 
    }
    fail("No IllegalArgumentException thrown");
    }    

    // Assert that a hash can be generated by the hash function
    @Test
    public void testInvalidHash() {
	int hash = Integer.valueOf("00ffffff", 16);
    LaboonCoin l = new LaboonCoin();

    assertFalse(l.validHash(3, hash));
    }

    // Assert that a hash can be generated by the hash function
    @Test
    public void testVaildHashThree() {
	int hash = Integer.valueOf("000fffff", 16);
    LaboonCoin l = new LaboonCoin();

    assertTrue(l.validHash(3, hash));
    }

    // Assert that a hash can be generated by the hash function
    @Test
    public void testValidHash() {
	int hash = Integer.valueOf("0000ffff", 16);
    LaboonCoin l = new LaboonCoin();
    assertTrue(l.validHash(3, hash));
    }

    @Test
    public void testCreateBlock1() {
        LaboonCoin l = new LaboonCoin();
        String data = "boo";
        int prevHash = 0x00000000;
        int nonce = 0x000010bb;
        int hash = 0x000b43be;

        assertEquals("boo|00000000|000010bb|000b43be", l.createBlock(data, prevHash, nonce, hash));
    }

    @Test
    public void testCreateBlock2() {
        LaboonCoin l = new LaboonCoin();
        String data = "boo";
        int prevHash = 0x00000000;
        int nonce = 0x000010bb;
        int hash = 0x000b43be;

        assertEquals("boo|00000000|000010bb|000b43be", l.createBlock(data, prevHash, nonce, hash));
    }

    @Test
    public void testCreateBlock3() {
        LaboonCoin l = new LaboonCoin();
        String data = "boo";
        int prevHash = 0x00000000;
        int nonce = 0x000010bb;
        int hash = 0x000b43be;

        assertEquals("boo|00000000|000010bb|000b43be", l.createBlock(data, prevHash, nonce, hash));
    }

    @Test
    public void testGetEmptyBlockChain() {
        LaboonCoin l = new LaboonCoin();
        
        assertEquals("", l.getBlockChain());
    }

    @Test
    public void testGetSingleBlockChain() {
        LaboonCoin l = new LaboonCoin();
        
        l.blockchain.add("boo|00000000|000010bb|000b43be");

        assertEquals("boo|00000000|000010bb|000b43be\n", l.getBlockChain());
    }

    @Test
    public void testGetMultipleBlockChain() {
        LaboonCoin l = new LaboonCoin();
        
        l.blockchain.add("boo|00000000|000010bb|000b43be");
        l.blockchain.add("boo|000b43be|000005a1|00075500");
        l.blockchain.add("boo|00075500|000016da|000f593c");
        l.blockchain.add("quock|000f593c|00000229|000064f6");

        String expected = "boo|00000000|000010bb|000b43be\n"
        + "boo|000b43be|000005a1|00075500\n"
        + "boo|00075500|000016da|000f593c\n"
        + "quock|000f593c|00000229|000064f6\n";

        assertEquals(expected, l.getBlockChain());
    }
}
